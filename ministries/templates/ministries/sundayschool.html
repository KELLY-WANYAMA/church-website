<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACK ST. JUDE'S HURUMA</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


    <header>
        <nav class="navbar">
    <div class="logo">
        <div class="hamburger">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>
        <a href="/">ðŸŒŸ ACK ST JUDES HURUMA</a>
    </div>
    <ul class="nav-links">
        <li><a href="/">HOME</a></li>
        <li class="dropdown">
            <a href="#">ABOUT â–¾</a>
            <ul class="dropdown-menu">
                <li><a href="/about">ABOUT US</a></li>
                <li><a href="/events">EVENTS</a></li>
                <li><a href="/gallery">GALLERY</a></li>
                <li><a href="/giving">GIVING</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="#">MINISTRIES â–¾</a>
            <ul class="dropdown-menu">
                <li><a href="/ministries">OUR MINISTRIES</a></li>
                <li><a href="/ministries/youth">YOUTH</a></li>
                <li><a href="/ministries/mu">MOTHER'S UNION</a></li>
                <li><a href="/ministries/kama">KAMA</a></li>
                <li><a href="/ministries/sundayschool">SUNDAY SCHOOL</a></li>
                <li><a href="/ministries/choir_worship">CHOIR / WORSHIP TEAM</a></li>
            </ul>
        </li>
        <li><a href="/sermons">SERMONS</a></li>
        <li><a href="/contacts">CONTACT</a></li>
    </ul>

</nav>
    </header>
</head>
<body>

{% block content %}

    <!-- Hero Section -->
    <section class="sunday-hero">
        <div class="hero-content">
            <h1>ACK Sunday School</h1>
            <p class="tagline">"Train up a child in the way he should go; even when he is old he will not depart from it." - Proverbs 22:6</p>
            <div class="hero-buttons">
                <a href="#age-groups" class="cta-button primary-btn"><i class="fas fa-child"></i> Age Groups</a>
                <a href="#registration" class="cta-button secondary-btn"><i class="fas fa-users"></i> Register</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-sunday">
        <div class="container">
            <h2>About Our Sunday School</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>Welcome to the ACK St Judes Huruma Sunday School, where we nurture children in the Anglican faith tradition through engaging lessons, activities, and fellowship.</p>
                    
                    <p>Our Sunday School provides a safe and loving environment for children to learn about God's love, grow in their faith, and build lasting friendships.</p>

                    <div class="ack-values">
                        <h3>Our Anglican Values</h3>
                        <ul>
                            <li><i class="fas fa-bible"></i> Bible-based teaching</li>
                            <li><i class="fas fa-pray"></i> Prayer and worship</li>
                            <li><i class="fas fa-hands-helping"></i> Service and outreach</li>
                            <li><i class="fas fa-church"></i> Sacramental life</li>
                        </ul>
                    </div>
                </div>
                <div class="about-image">
                    <img src="{% static 'image/youthkesha.png' %}" alt="ACK Sunday school Members">
                </div>
            </div>
        </div>
    </section>

    <!-- Age Groups Section -->
    <section id="age-groups" class="age-groups">
        <div class="container">
            <h2>Age Groups & Activities</h2>
            
            <div class="age-tabs">
                <button class="age-tab active" data-age="nursery">Nursery (3-5 years)</button>
                <button class="age-tab" data-age="primary">Primary (6-9 years)</button>
                <button class="age-tab" data-age="juniors">Juniors (10-12 years)</button>
            </div>

            <!-- Nursery Age Group -->
            <div class="age-content active" id="nursery-content">
                <div class="age-grid">
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-music"></i></div>
                        <h4>Bible Songs & Rhymes</h4>
                        <p>Fun, interactive songs that teach simple Bible stories and Christian values</p>
                        <span class="activity-time">30 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-palette"></i></div>
                        <h4>Coloring & Crafts</h4>
                        <p>Simple coloring pages and crafts based on Bible stories</p>
                        <span class="activity-time">45 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-book-bible"></i></div>
                        <h4>Story Time</h4>
                        <p>Interactive Bible story reading with visual aids and puppets</p>
                        <span class="activity-time">30 minutes</span>
                    </div>
                </div>
            </div>

            <!-- Primary Age Group -->
            <div class="age-content" id="primary-content">
                <div class="age-grid">
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-puzzle-piece"></i></div>
                        <h4>Bible Games</h4>
                        <p>Interactive games that teach Bible stories and Christian values</p>
                        <span class="activity-time">45 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-theater-masks"></i></div>
                        <h4>Role Playing</h4>
                        <p>Acting out Bible stories to understand their lessons</p>
                        <span class="activity-time">40 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-pray"></i></div>
                        <h4>Simple Prayers</h4>
                        <p>Learning and practicing simple prayers together</p>
                        <span class="activity-time">25 minutes</span>
                    </div>
                </div>
            </div>

            <!-- Juniors Age Group -->
            <div class="age-content" id="juniors-content">
                <div class="age-grid">
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-book-open"></i></div>
                        <h4>Bible Study</h4>
                        <p>Deeper exploration of Bible stories and their meanings</p>
                        <span class="activity-time">50 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-hand-holding-heart"></i></div>
                        <h4>Service Projects</h4>
                        <p>Small community service activities and outreach</p>
                        <span class="activity-time">60 minutes</span>
                    </div>
                    <div class="activity-card">
                        <div class="activity-icon"><i class="fas fa-users"></i></div>
                        <h4>Group Discussions</h4>
                        <p>Discussing how to apply Bible lessons in daily life</p>
                        <span class="activity-time">45 minutes</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

        <!-- Schedule Section -->
    <section class="schedule">
        <div class="container">
            <h2>Weekly Schedule</h2>
            <div class="schedule-grid">
                {% for schedule in schedules %}
                <div class="schedule-card">
                    <h3>{{ schedule.title }}</h3>
                    {% if schedule.description %}
                        <p class="schedule-description">{{ schedule.description }}</p>
                    {% endif %}
                    {% for item in schedule.items.all %}
                    <div class="schedule-item">
                        <span class="schedule-time">{{ item.time }}</span>
                        <span class="schedule-activity">{{ item.activity }}</span>
                        {% if item.description %}
                            <p class="item-description">{{ item.description }}</p>
                        {% endif %}
                    </div>
                    {% empty %}
                    <div class="no-items">
                        <p>No schedule items available.</p>
                    </div>
                    {% endfor %}
                </div>
                {% empty %}
                <div class="no-schedules">
                    <p>Schedule information coming soon.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

        <!-- Teachers Section -->
    <section class="teachers">
        <div class="container">
            <h2>Our Teachers</h2>
            <div class="teachers-grid">
                {% for teacher in teachers %}
                <div class="teacher-card">
                    {% if teacher.image %}
                        <img src="{{ teacher.image.url }}" alt="{{ teacher.name }}">
                    {% else %}
                        <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=400&q=80" alt="{{ teacher.name }}">
                    {% endif %}
                    <h4>{{ teacher.name }}</h4>
                    <p>{{ teacher.position }}</p>
                    <span class="teacher-age">{{ teacher.get_age_group_display }}</span>
                    {% if teacher.bio %}
                        <p class="teacher-bio">{{ teacher.bio }}</p>
                    {% endif %}
                </div>
                {% empty %}
                <div class="no-teachers">
                    <p>Teacher information coming soon.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

        <!-- Registration Section -->
    <section id="registration" class="registration">
        <div class="container">
            <h2>Join Our Sunday School</h2>
            <div class="reg-content">
                <div class="reg-info">
                    {% if why_join_info %}
                    <h3>{{ why_join_info.title }}</h3>
                    <ul>
                        {% for item in why_join_info.items.all %}
                        <li>{{ item.text }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    
                    {% if requirements_info %}
                    <h3>{{ requirements_info.title }}</h3>
                    <ul>
                        {% for item in requirements_info.items.all %}
                        <li>{{ item.text }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
                
                <div class="reg-form">
                    <h3>Registration Form</h3>
                    <form class="interest-form" id="sundaySchoolRegistrationForm">
                        {% csrf_token %}
                        <input type="text" name="child_name" placeholder="Child's Full Name" required>
                        <input type="number" name="child_age" placeholder="Child's Age" min="3" max="12" required>
                        <select name="age_group" required>
                            <option value="">Select Age Group</option>
                            <option value="nursery">Nursery (3-5 years)</option>
                            <option value="primary">Primary (6-9 years)</option>
                            <option value="juniors">Juniors (10-12 years)</option>
                        </select>
                        <input type="text" name="parent_name" placeholder="Parent/Guardian Name" required>
                        <input type="tel" name="phone" placeholder="Phone Number" required>
                        <input type="email" name="email" placeholder="Email Address">
                        <textarea name="special_notes" placeholder="Any special notes or requirements" rows="3"></textarea>
                        <button type="submit">Register Now</button>
                        
                        <!-- Success/Error Messages -->
                        <div id="registration-message" style="display: none; margin-top: 15px; padding: 10px; border-radius: 5px;"></div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    
    <!-- Bible Verse Section -->
    <section class="bible-verse">
        <div class="container">
            <blockquote>
                "But Jesus said, 'Let the little children come to me and do not hinder them, for to such belongs the kingdom of heaven.'"
                <cite>- Matthew 19:14</cite>
            </blockquote>
        </div>
    </section>

{% endblock %}



<!-- Footer Section -->
<footer class="footer">
    <div class="footer-container">
        <div class="footer-section">
            <h3>ACK ST JUDES HURUMA</h3>
            <p>A place to belong, believe, and become in Christ.</p>
            <div class="social-links">
                <a href="https://www.facebook.com/profile.php?id=100069972304998" target="_blank"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="https://www.youtube.com/@ackstjudesparish-huruma" target="_blank"><i class="fab fa-youtube"></i></a>
                <a href="https://www.tiktok.com/@ack.st.judes.huru" target="_blank"><i class="fab fa-tiktok"></i></a>
            </div>
        </div>

        <div class="footer-section">
            <h3>Quick Links</h3>
            <ul>
                <li><a href="{% url 'home' %}">Home</a></li>
                <li><a href="{% url 'about' %}">About Us</a></li>
                <li><a href="{% url 'sermons' %}">Sermon</a></li>
                <li><a href="{% url 'events' %}">Events</a></li>
                <li><a href="{% url 'contacts' %}">Contact</a></li>
            </ul>
        </div>

        <div class="footer-section">
            <h3>Contact Info</h3>
            <p><i class="fas fa-map-marker-alt"></i> Church Road, Westlands, Nairobi</p>
            <p><i class="fas fa-phone"></i> +254 718 437784</p>
            <p><i class="fas fa-envelope"></i> info@stjudeshuruma.org</p>
        </div>

        <div class="footer-section">
            <h3>Service Times</h3>
            <p>Sunday: 7:30 AM To 1:00 PM</p>
            <p>Wednesday: 6:30 AM To 6:30 PM (Maombi Wednesday)</p>
        </div>
    </div>

    <div class="footer-bottom">
        <p>&copy; 2025 ACK ST JUDES HURUMA. All Rights Reserved.</p>
        <p>Designed and developed by <a href="https://nicekelly.netlify.app/" target="_blank"> Kelly</a> </i> To God Be The Glory</p>
    </div>
</footer>
<!--end of footer-->






<script>
// Main initialization when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    initializeAllFunctions();
});

function initializeAllFunctions() {
    // Initialize all components
    initializeFormHandlers();
    initializeTabFunctionality();
    initializeMobileNavigation();
    initializeSmoothScrolling();
    initializeEventCards();
}

// FORM HANDLERS =============================================================
function initializeFormHandlers() {
    // Sunday School Registration Form
    const sundaySchoolForm = document.getElementById('sundaySchoolRegistrationForm');
    if (sundaySchoolForm) {
        // Use Django template tag for URL - FIXED
        setupFormHandler(sundaySchoolForm, '/ministries/submit_sunday_school_registration/', 'registration-message');
    }

    // Add other form handlers here as needed
    // Example: Youth registration, general contact forms, etc.
}

function setupFormHandler(form, submitUrl, messageDivId) {
    const messageDiv = document.getElementById(messageDivId);
    
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const submitButton = this.querySelector('button[type="submit"]');
        const originalText = submitButton.textContent;
        
        // Show loading state
        submitButton.textContent = 'Sending...';
        submitButton.disabled = true;
        if (messageDiv) messageDiv.style.display = 'none';

        try {
            const formData = new FormData(this);
            const formObject = {};
            
            // Convert FormData to object
            for (let [key, value] of formData.entries()) {
                formObject[key] = value;
            }

            console.log('Submitting to:', submitUrl); // Debug log
            console.log('Form data:', formObject); // Debug log

            const response = await fetch(submitUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCSRFToken()
                },
                body: JSON.stringify(formObject)
            });

            console.log('Response status:', response.status); // Debug log

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            console.log('Response data:', data); // Debug log

            if (data.success || data.status === 'success') {
                showMessage(data.message || 'Thank you! We will contact you soon.', 'success', messageDiv);
                this.reset();
            } else {
                showMessage(data.message || 'There was an error. Please try again.', 'error', messageDiv);
            }

            // Scroll to message if it exists
            if (messageDiv) {
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

        } catch (error) {
            console.error('Full error details:', error);
            showMessage(`Network error: ${error.message}. Please check the console for details.`, 'error', messageDiv);
        } finally {
            // Restore button state
            submitButton.textContent = originalText;
            submitButton.disabled = false;
        }
    });
}

function getCSRFToken() {
    // Try to get CSRF token from template tag or form input
    const csrfInput = document.querySelector('[name=csrfmiddlewaretoken]');
    if (csrfInput) {
        console.log('CSRF token found in input');
        return csrfInput.value;
    }
    
    // Fallback to cookie method
    const csrfCookie = getCookie('csrftoken');
    if (csrfCookie) {
        console.log('CSRF token found in cookie');
        return csrfCookie;
    }
    
    console.log('No CSRF token found');
    return '';
}

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function showMessage(text, type, messageDiv) {
    if (!messageDiv) return;
    
    messageDiv.textContent = text;
    messageDiv.style.display = 'block';
    
    // Apply styles based on message type
    if (type === 'success') {
        messageDiv.style.backgroundColor = '#d4edda';
        messageDiv.style.color = '#155724';
        messageDiv.style.border = '1px solid #c3e6cb';
    } else {
        messageDiv.style.backgroundColor = '#f8d7da';
        messageDiv.style.color = '#721c24';
        messageDiv.style.border = '1px solid #f5c6cb';
    }
    
    // Auto-hide success messages after 8 seconds
    if (type === 'success') {
        setTimeout(() => {
            messageDiv.style.display = 'none';
        }, 8000);
    }
}

// TAB FUNCTIONALITY =========================================================
function initializeTabFunctionality() {
    const tabs = document.querySelectorAll('.age-tab');
    const contents = document.querySelectorAll('.age-content');

    tabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const ageGroup = this.getAttribute('data-age');
            
            // Remove active class from all tabs and contents
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            this.classList.add('active');
            const targetContent = document.getElementById(`${ageGroup}-content`);
            if (targetContent) targetContent.classList.add('active');
        });
    });
}

// EVENT CARDS FUNCTIONALITY =================================================
function initializeEventCards() {
    // Event cards are handled by the global toggleEventDetails function
}

function toggleEventDetails(button) {
    const eventCard = button.closest('.event-card');
    const isExpanded = eventCard.classList.contains('expanded');
    
    // Close all other expanded cards
    const expandedCards = document.querySelectorAll('.event-card.expanded');
    expandedCards.forEach(card => {
        if (card !== eventCard) {
            closeEventCard(card);
        }
    });
    
    // Toggle current card
    if (isExpanded) {
        closeEventCard(eventCard);
    } else {
        openEventCard(eventCard, button);
    }
}

function closeEventCard(card) {
    card.classList.remove('expanded');
    const button = card.querySelector('.event-button');
    if (button) {
        const btnText = button.querySelector('.btn-text');
        if (btnText) btnText.textContent = 'Details';
    }
}

function openEventCard(card, button) {
    card.classList.add('expanded');
    const btnText = button.querySelector('.btn-text');
    if (btnText) btnText.textContent = 'Less Info';
    
    // Scroll to ensure the expanded content is visible
    card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Close expanded cards when clicking outside
document.addEventListener('click', function(e) {
    const isEventButton = e.target.classList.contains('event-button') || 
                        e.target.closest('.event-button');
    const isInsideExpandedCard = e.target.closest('.event-card.expanded');
    
    if (!isInsideExpandedCard && !isEventButton) {
        const expandedCards = document.querySelectorAll('.event-card.expanded');
        expandedCards.forEach(card => {
            closeEventCard(card);
        });
    }
});

// Close expanded cards on escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const expandedCards = document.querySelectorAll('.event-card.expanded');
        expandedCards.forEach(card => {
            closeEventCard(card);
        });
    }
});

// MOBILE NAVIGATION =========================================================
function initializeMobileNavigation() {
    const hamburger = document.querySelector('.hamburger');
    const navLinks = document.querySelector('.nav-links');
    const dropdowns = document.querySelectorAll('.dropdown');

    // Mobile menu toggle
    if (hamburger && navLinks) {
        hamburger.addEventListener('click', function() {
            this.classList.toggle('active');
            navLinks.classList.toggle('show');
            
            // Close dropdowns when closing mobile menu
            if (!navLinks.classList.contains('show')) {
                closeAllDropdowns(dropdowns);
            }
        });
    }

    // Dropdown functionality for mobile
    setupMobileDropdowns(dropdowns);

    // Close mobile menu when clicking outside
    setupClickOutsideHandler(hamburger, navLinks, dropdowns);

    // Close mobile menu on resize to desktop
    setupResizeHandler(navLinks, hamburger, dropdowns);
}

function setupMobileDropdowns(dropdowns) {
    dropdowns.forEach(dropdown => {
        const link = dropdown.querySelector('a');
        if (link) {
            link.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    const menu = this.nextElementSibling;
                    if (menu && menu.classList.contains('dropdown-menu')) {
                        menu.classList.toggle('show');
                        
                        // Close other dropdowns
                        dropdowns.forEach(otherDropdown => {
                            if (otherDropdown !== dropdown) {
                                const otherMenu = otherDropdown.querySelector('.dropdown-menu');
                                if (otherMenu) otherMenu.classList.remove('show');
                            }
                        });
                    }
                }
            });
        }
    });
}

function setupClickOutsideHandler(hamburger, navLinks, dropdowns) {
    document.addEventListener('click', function(e) {
        if (window.innerWidth <= 768) {
            const isHamburger = e.target.closest('.hamburger');
            const isNavLink = e.target.closest('.nav-links');
            const isDropdown = e.target.closest('.dropdown');
            
            if (!isHamburger && !isNavLink && !isDropdown && navLinks && navLinks.classList.contains('show')) {
                closeMobileMenu(navLinks, hamburger, dropdowns);
            }
        }
    });
}

function setupResizeHandler(navLinks, hamburger, dropdowns) {
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768 && navLinks && navLinks.classList.contains('show')) {
            closeMobileMenu(navLinks, hamburger, dropdowns);
        }
    });
}

function closeMobileMenu(navLinks, hamburger, dropdowns) {
    navLinks.classList.remove('show');
    if (hamburger) hamburger.classList.remove('active');
    closeAllDropdowns(dropdowns);
}

function closeAllDropdowns(dropdowns) {
    dropdowns.forEach(dropdown => {
        const menu = dropdown.querySelector('.dropdown-menu');
        if (menu) menu.classList.remove('show');
    });
}

// SMOOTH SCROLLING ==========================================================
function initializeSmoothScrolling() {
    const anchorLinks = document.querySelectorAll('a[href^="#"]');
    
    anchorLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            
            if (href !== '#' && href.startsWith('#')) {
                e.preventDefault();
                const target = document.querySelector(href);
                
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Close mobile menu if open
                    const navLinks = document.querySelector('.nav-links');
                    const hamburger = document.querySelector('.hamburger');
                    if (navLinks && navLinks.classList.contains('show')) {
                        closeMobileMenu(navLinks, hamburger, document.querySelectorAll('.dropdown'));
                    }
                }
            }
        });
    });
}
</script>
</body>
</html>



